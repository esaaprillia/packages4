From 6b0b54dc8e6185af9372d4477481a0c04a777db6 Mon Sep 17 00:00:00 2001
From: esaaprillia <esaapriliasalsabila@gmail.com>
Date: Tue, 18 Feb 2025 21:34:35 +0800
Subject: [PATCH] Update CMakeLists.txt

---
 CMakeLists.txt | 14 +++++---------
 1 file changed, 5 insertions(+), 9 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 9d35815..46b6c7c 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -1079,7 +1079,7 @@ IF(XNNPACK_BUILD_ALL_MICROKERNELS)
 ENDIF()
 TARGET_INCLUDE_DIRECTORIES(datatype PRIVATE include src)
 TARGET_INCLUDE_DIRECTORIES(microkernels-prod PRIVATE include src)
-TARGET_INCLUDE_DIRECTORIES(hardware-config PRIVATE include src ${CPUINFO_SOURCE_DIR}/include)
+TARGET_INCLUDE_DIRECTORIES(hardware-config PRIVATE include src @STAGING_DIR@/include)
 TARGET_INCLUDE_DIRECTORIES(indirection PRIVATE include src)
 TARGET_INCLUDE_DIRECTORIES(microparams-init PRIVATE include src)
 TARGET_INCLUDE_DIRECTORIES(normalization PRIVATE include src)
@@ -1135,11 +1135,10 @@ IF(NOT TARGET cpuinfo)
       "${CMAKE_BINARY_DIR}/cpuinfo")
   ELSE()
     ADD_LIBRARY(cpuinfo SHARED IMPORTED)
-    FIND_LIBRARY(CPUINFO_LIBRARY cpuinfo PATHS "${CPUINFO_SOURCE_DIR}/lib")
+    FIND_LIBRARY(CPUINFO_LIBRARY cpuinfo "@STAGING_DIR@/lib")
     IF(NOT CPUINFO_LIBRARY)
       MESSAGE(FATAL_ERROR "Cannot find cpuinfo")
     ENDIF()
-    TARGET_INCLUDE_DIRECTORIES(cpuinfo INTERFACE "${CPUINFO_SOURCE_DIR}/include")
     SET_PROPERTY(TARGET cpuinfo PROPERTY IMPORTED_LOCATION "${CPUINFO_LIBRARY}")
     SET_PROPERTY(TARGET cpuinfo PROPERTY IMPORTED_IMPLIB "${CPUINFO_LIBRARY}")
   ENDIF()
@@ -1160,12 +1159,11 @@ IF(NOT TARGET pthreadpool)
       "${CMAKE_BINARY_DIR}/pthreadpool")
   ELSE()
     ADD_LIBRARY(pthreadpool SHARED IMPORTED)
-    FIND_LIBRARY(PTHREADPOOL_LIBRARY pthreadpool PATHS "${PTHREADPOOL_SOURCE_DIR}/lib")
+    FIND_LIBRARY(PTHREADPOOL_LIBRARY pthreadpool "@STAGING_DIR@/lib")
     IF(NOT PTHREADPOOL_LIBRARY)
       MESSAGE(FATAL_ERROR "Cannot find pthreadpool")
     ENDIF()
     FIND_PACKAGE(Threads REQUIRED)
-    TARGET_INCLUDE_DIRECTORIES(pthreadpool INTERFACE "${PTHREADPOOL_SOURCE_DIR}/include")
     TARGET_LINK_LIBRARIES(pthreadpool INTERFACE Threads::Threads)
     SET_PROPERTY(TARGET pthreadpool PROPERTY IMPORTED_LOCATION "${PTHREADPOOL_LIBRARY}")
     SET_PROPERTY(TARGET pthreadpool PROPERTY IMPORTED_IMPLIB "${PTHREADPOOL_LIBRARY}")
@@ -1182,12 +1180,11 @@ IF(NOT TARGET fxdiv)
       "${FXDIV_SOURCE_DIR}"
       "${CMAKE_BINARY_DIR}/FXdiv")
   ELSE()
-    FIND_FILE(FXDIV_HDR fxdiv.h PATH_SUFFIXES include PATHS "${FXDIV_SOURCE_DIR}")
+    FIND_FILE(FXDIV_HDR fxdiv.h "@STAGING_DIR@/include")
     IF(NOT FXDIV_HDR)
       MESSAGE(FATAL_ERROR "Cannot find fxdiv")
     ENDIF()
     ADD_LIBRARY(fxdiv STATIC "${FXDIV_HDR}")
-    TARGET_INCLUDE_DIRECTORIES(fxdiv INTERFACE "${FXDIV_SOURCE_DIR}/include")
     SET_PROPERTY(TARGET fxdiv PROPERTY LINKER_LANGUAGE C)
   ENDIF()
 ENDIF()
@@ -1217,11 +1214,10 @@ IF(XNNPACK_ENABLE_KLEIDIAI)
         "${CMAKE_BINARY_DIR}/kleidiai")
     ELSE()
       ADD_LIBRARY(kleidiai SHARED IMPORTED)
-      FIND_LIBRARY(KLEIDIAI_LIBRARY kleidiai PATHS "${KLEIDIAI_SOURCE_DIR}/lib")
+      FIND_LIBRARY(KLEIDIAI_LIBRARY kleidiai "@STAGING_DIR@/lib")
       IF(NOT KLEIDIAI_LIBRARY)
         MESSAGE(FATAL_ERROR "Cannot find KleidiAI")
       ENDIF()
-      TARGET_INCLUDE_DIRECTORIES(kleidiai INTERFACE "${KLEIDIAI_SOURCE_DIR}")
       SET_PROPERTY(TARGET kleidiai PROPERTY IMPORTED_LOCATION "${KLEIDIAI_LIBRARY}")
       SET_PROPERTY(TARGET kleidiai PROPERTY IMPORTED_IMPLIB "${KLEIDIAI_LIBRARY}")
     ENDIF()
